{% extends 'base.html.twig' %}
{% block title %}Investments: {{ grouping }}{% endblock %}
{% block body %}
    <h1 style="color: red">Investments: {{ grouping }}</h1>
    {% set AsOfDate = settings.investmentDate  %}
    {% include 'investments/parts/economic/economic_view_buttons.twig' %}

    {% include 'investments/parts/economic/bank_accounts_buttons.twig' %}
    {% include 'bank_balances/parts/summary_bank_acounts.html.twig' %}

    {% include 'investments/parts/economic/loans_bonds_buttons.twig' %}
    {% include 'loans_bonds/parts/loans_bonds_headers.html.twig' %}
    {% include 'loans_bonds/parts/loans_bonds_body.html.twig' %}



    <table class="table table-responsive economicSummary">

        {% include 'investments/parts/economic/investments_economic_headers.html.twig' %}
        <tbody>
        {% set TaxSubsidyPurchase_Total = 0 %}
        {% set MTM_Total = 0 %}
        {% set PV_Total = 0 %}
        {% set CGT_Total = 0 %}
        {% set totalLossDeductibleAgainstIncome = 0 %}
        {% for investment in investments %}
            {% set totalLossDeductibleAgainstIncome = totalLossDeductibleAgainstIncome +  investment.lossDeductibleAgainstIncome %}
            {% if 1 == 1 %}
                {% set FXEffect =1 %}
                {% set InitialFXRate =1 %}
                {% set CurrentFXRate =1 %}
                {% if investment.currency.fx != "GBP" %}
                    {% set InitialFXRate =  (investment.investmentAmount/(investment.initialInvestmentAmountGBP +0.00001)) %}
                    {% set CurrentFXRate =  USDGBPFXrate.currentFxRate /investment.currency.currentFxRate %}
                    {% set FXEffect = InitialFXRate/CurrentFXRate %}
                {% endif %}
                {% set investmentChildID = 'investment'~investment.id %}
                {% include 'investments/parts/economic/investments_economic_body.html.twig' %}
            {% endif %}
        {% endfor %}
        </tbody>
        {#        <tfoot> #}
        {#                {% include 'investments/parts/investments_incl_tax_footer.html.twig' %} #}
        {#        </tfoot> #}
    </table>
    <br>
{% endblock %}


{% block additionaljs %}
    <script>
        $(".investmentsChildren").hide();
        $('.toggle-investment-child').click(function () {
            var investment_Child_ID = $(this).attr("data-investment-Child-Id");
            $("#" + investment_Child_ID).toggle();
        })
    </script>
{% endblock additionaljs %}
{% block datatable %}
    <script>
        $(document).ready(function () {
            $('.bankAccountSummary').DataTable({
                'pageLength': 50,
                "order": [[1, 'asc'] ],
                "paging": false,
                "searching": false,
                "bInfo": false
            });
            $('.economicSummary').DataTable({
                'pageLength': 50,
                "order": [[0, 'asc'],[2, 'asc']],
                "paging": false,
                "searching": false,
                "bInfo": false
            });
        });
    </script>
{% endblock datatable %}