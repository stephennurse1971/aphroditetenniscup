{% extends 'base.html.twig' %}
{% block title %}Edit: {{ user.fullname }}{% endblock %}

{% block body %}
    <h1 style="color: red"><span class="text-danger">{{ user.fullName }}</span></h1>

    {{ include('user/_form.html.twig', {'button_label': 'Save (no welcome email)'}) }}
    <br>
    <br>
    <a class="btn btn-outline-primary btn-sm mt-1 mb-1" href="{{ path('user_index') }}">Don't save & Return to list</a>
    {% if is_granted ('ROLE_SUPER_ADMIN') %}
        {{ include('user/_delete_form.html.twig') }}
    {% endif %}
    <div id="pw" data="{{ password }}"></div>
    {% set count=0 %}
    {% for role in roles %}
        {% if role != "ROLE_USER" %}
            {% set count=count + 1 %}
            {% set id = 'role'~count %}
            <div id="{{ id }}" data-role{{ count }}="{{ role }}"></div>
        {% endif %}
    {% endfor %}
    <div id="counter" data-count="{{ count }}"></div>
{% endblock %}



{% block additionaljs %}
    <script>
        $('document').ready(function () {
            var pw = $('#pw').attr('data');
            $('#user_password').val(pw).change();
            var counter = $('#counter').attr('data-count');

            for (let i = 1; i <= counter; i++) {
                var role = $("#role" + i).attr("data-role" + i);
                $('input[value="' + role + '"]').prop('checked', true);
            }
        })
    </script>

    <script>
        $('#sendEmail').click(function (e) {
            e.preventDefault();
            $('#user_sendEmail').val(1).change();
            /*  e.unbind();*/
            $('#save').trigger('click');
        });
    </script>
{% endblock additionaljs %}



