{% extends 'base.html.twig' %}

{% block title %}Edit: {{ user.fullname }}{% endblock %}

{% block body %}
    <h1 style="color: red"><span class="text-danger">{{user.fullName}}</span></h1>

    {{ include('user/_form.html.twig', {'button_label': 'Save (no welcome email)'}) }}
<br>
<br>
    <a class="btn btn-outline-primary btn-sm mt-1 mb-1" href="{{ path('user_index') }}">Don't save & Return to list</a>

   {{ include('user/_delete_form.html.twig') }}
    <div id="pw" data="{{ password }}"></div>
    {% set count=0 %}
    {% for role in roles %}
        {% set count=count + 1 %}
        {% set id = 'role'~count %}
    <div id="{{ id }}" data-role{{ count }}="{{ role }}"></div>

   {% endfor %}
<div id="counter" data-count="{{ count }}"></div>
{% endblock %}


{% block additionaljs %}
    <script>
        var pw = $('#pw').attr('data');
        $('#user_password').val(pw).change();
        var counter = $('#counter').attr('data-count');

 for(let i=1; i<counter;i++){

    var role = $("#role"+i).attr("data-role"+i);

     $('input[value="'+role+'"]').prop('checked', true);
 }


    </script>
{% endblock additionaljs %}

{% block javascripts %}
    {{ parent() }}

    <script>
        $('#sendEmail').click(function (e) {
            e.preventDefault();
            $('#user_sendEmail').val(1).change();/*
            e.unbind();*/
            $('#save').trigger('click');
        });

    </script>
{% endblock javascripts %}